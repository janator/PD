# ДЗ №2. Программирование на CUDA
Предлагается решить 1 из 3 задач. Решение можно писать на CUDA API либо на PyCUDA, **но не CUBLAS**. Для проведения экспериментов (запуска кода несколько раз с различными параметрами) можно использовать любой инструментарий.

Сервер для работы: `ssh <user>@lorien.atp-fivt.org`

|Уровень|Максимальная оценка|%|
|---|---|---|
|1|1,5 балла|75%|
|2|2 балла|100%|
|3|3 балла|150%|

<p>
<details>
<summary markdown="span"><h3> Сроки сдачи </h3></summary>

| Группа | Soft deadline | Hard deadline (-50%) |
| ---      |  ------  |------|
|Б05-812|24.10, 23:59|31.10, 23:59|
|Б05-824 и Б05-825|24.10, 23:59|31.10, 23:59|
|Б05-822|18.10, 23:59|25.10, 23:59|
|Б05-811|19.10, 23:59|26.10, 23:59|
|Б05-821 и Б05-831|19.10, 23:59|26.10, 23:59|
|Б05-813|20.10, 23:59|27.10, 23:59|
|Б05-823|20.10, 23:59|27.10, 23:59|
|Б05-826|20.10, 23:59|27.10, 23:59|

Исправлять коды после комментариев можно в течение месяца после проверки.

</details>
</p>

# Уровень 1. Вычисление параметров нормального распределения
Пусть z - нормальная случайная величина. 
На вход подаются параметры `a`, `b`, `c`, необходимо вычислить значение `az^2 + bz + c`.

### Особенности реализации
1. Переменные `a`, `b` и `c` необходимо заключить в константную область памяти `__constant__` - сравните скорость работы с загрузкой через параметры функции.
2. Исследуйте возможности ILP (Instruction Level Parallelism): попробуйте поставить количество блоков, равное 1, после чего загрузить значения в переменных через цикл. Необходимо выбрать оптимальное число блоков, количество итераций цикла для просчета функции. Для пункта 2 постройте график зависимости времени работы программы от ILP.
3. Попробуйте реализовать генерацию случайных величин на `host` и на `device`. Сравните время работы обоих вариантов. программы.

Среднее значение должно быть приблизительно равно `a + c`.

Результаты сравнения удобно представлять в виде списка или таблиц такого типа:

<p>
<details>
<summary markdown="span"><h4> Пример</h4> </summary>

#### Задание 1
|Программа|Время работы|
|---|---|
|Передача переменных через аргументв|0.xxx|
|Использование констант|0.yyy|

</details>
</p>

### Полезная литература

* https://docs.nvidia.com/cuda/curand/host-api-overview.html#host-api-example - пример генерации случайных величин на хосте
* https://docs.nvidia.com/cuda/curand/device-api-overview.html#device-api-example - пример генерации случайных величин на устройстве
* https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__MEMORY.html#group__CUDART__MEMORY_1g9bcf02b53644eee2bef9983d807084c7 - копирование в константу

# Уровень 2. Перемножение матриц

На вход подаются две матрицы `A` и `B`. Можно считать, что их размерности кратны длине блока. Необходимо посчитать их произведение.

### Особенности реализации

1. Используйте shared память для подсчета произведения внутри блока.
2. Замерьте время работы и сравните его с [наивной](https://github.com/akhtyamovpavel/ParallelComputationExamples/blob/master/CUDA/03.5-matrix-multiplication-example/) реализацией.

# Уровень 3. Быстрая сортировка

На вход подается массив A, необходимо отсортировать его значения по возрастанию.

### Особенности реализации
1. Для реализации операции "получить значения элементов, значения которых меньше x" стоит использовать операцию сканирования.
2. На занятиях было разобрано, каким образом можно выполнить операцию сканирования на одном блоке, необходимо расширить эту конструкцию на весь массив.
3. Требованием константности дополнительной памяти можно пренебречь

### Дополнительная литература
* https://www.eecs.umich.edu/courses/eecs570/hw/parprefix.pdf - в целом про сканирование
* https://www.drdobbs.com/parallel/quicksort-partition-via-prefix-scan/240003109 - быстрая сортировка при помощи подсчета суммы на префиксе

## Как сдать задание

1. Каждому из вас на почту пришел доступ на http://gitlab.atp-fivt.org/. (если всё ещё не пришел - стучитесь [сюда](https://forms.gle/SSL2e7FhE5iEdSoa9)). В http://gitlab.atp-fivt.org/ создан репозиторий `<ваше_ФИО>-cuda`.
2. Для каждой задачи (в данном случае она всего 1) для вас создана ветка, в которую нужно заливать решение.
3. Для сдачи задания нужно до deadline сделать pull request в master. В нем должен быть
    - код решения
    - результаты экспериментов: (1) графики, если требуется (в виде img, png или pdf), (2) результаты замеров времени.
    - код, позволяющий воспроизвести эксперимент для получения графика.
4. После deadline проверяющий (это может быть случайный семинарист или ассистент) оставляет комментарии и ставим *текущую оценку*. Если решение вцелом работает правильно и соответсвует требованиям, его можно исправлять (см. deadline по исправлениям) и повысить таким образом оценку.


